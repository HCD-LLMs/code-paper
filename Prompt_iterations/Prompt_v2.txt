expertise = "usability testing"
cat_users = "Doctor specialized in rhinocytology"
num_tasks = 5
system_name = "Rhino-Cyt"
system_desc = "It is a web application for rhinocytogram analysis that uses a deep neural network to automatically identify and classify cells from a nasal cytological preparation, based on a digital image taken directly from a microscope."

REQUEST = (
    f"""You are an expert in system {expertise}. Your task is to generate tasks for a user test performed by participants belonging to the category specified by the label {cat_users} in the system description message. Each task must meet the following characteristics:
    - Provide clear instructions on what participants should do
    - Avoid including words that appear in the product interface
    - Do not specify detailed steps to complete the task (e.g., avoid naming specific links or referencing link text)
    - Be atomic, meaning each task must have a single, clear goal

    To generate the tasks, follow these steps:
    1. Analyze the system description to be tested as indicated by the {system_desc} label in the system description message
    2. Analyze the interface images included in the message
    3. Identify the system's core functionalities, excluding typical features for its category (e.g., login or registration for web apps)
    4. Generate tasks that test the main functionalities of the system
    5. Verify that the generated tasks meet the specified requirements
    
    You must explore the html code of the application before generating the task. 
"""
)


    
CONTEXT = (f"""The system that is being tested is {system_name}. {system_desc}. The system's main functions include:
    - Automatic cell identification and classification: The system detects various types of cells such as artifacts, bacteria, red blood cells, eosinophils, epithelial cells, ciliated cells, lymphocytes, mast cells, metaplastic cells, mucus-producing cells, and neutrophils.
    - Display of test results: It provides a table showing the type of cell, the number of detected cells, the reference range, and a classification of their quantity.
    - Access to classified cell images: It allows visualization of the classified cell images, categorized by confidence level (low, medium, high).
    - Validation and correction of classifications: It allows the doctor to mark the classification of cells as “Correct” or “Incorrect” and, if incorrect, to correct it by selecting a new class and providing reasons why the original classification was wrong. These features support the doctor in reviewing and potentially correcting the automatic classifications provided by the system. 
"""
)

STRUCTURE = ("""
    The output must be divided in two sections: the first must be labeled as "Reasoning", which must contain the reasoning process that took you to generate the tasks, the second must be labeled "Tasks" and must contain the tasks in the following form:
             - <task1>
             - <task2>
             - ... 
""")

FOCUS = """
The objective of this usability test is to assess to which extent the Rhinocyt's interaction paradigm improve human understanding and control. Specifically, the interaction paradigm involves:
1. Clarification: providing understandable explanations about the inner workings of the AI system, enhancing user comprehension of its behavior and decisions. It aims to propose explanations thyat consider the application domain along with users’ needs and characteristics.
2. Reconfiguration: refers to enabling non-technical users to easily intervene on the retraining of the AI model. This becomes relevant when users identify incorrect predictions or when there is a need to integrate new data into the model improving its performance. 
3. Iterative Exploration: relates to reaching the system outcome through a sequence of iterative steps driven by the interaction between the user and the AI system. It involves to break down the decision-making process into progressive steps to recalibrate the user's request to the system.
"""


TEMPLATE = "\n\n".join([
    "[Request]\n" + REQUEST + "\n",
    "[Context]\n" + CONTEXT + "\n",
    "[HTML Code]\n{html_snippet}",
    "[Focus of the Study]" + FOCUS + "\n",
    "[Structure]\n" + STRUCTURE + "\n",
    #"ESEMPIO:\n```json\n"
    #"{{\n"
    #'  "elements": [...],\n'
    #'  "summary": "..." ,\n'
    #'  "count": 2\n'
    #"}}\n```"
])


prompt_template = PromptTemplate.from_template(TEMPLATE)

prompt_text = "\n\n".join([
    "[Request]\n" + REQUEST + "\n",
    "[Context]\n" + CONTEXT + "\n",
    "[Focus of the Study]" + FOCUS + "\n",
    "[Structure]\n" + STRUCTURE + "\n"])